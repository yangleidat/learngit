[ 搭建Django]

## 工具

- pycharm

- MySQL

- Navicat

---

## 配置顺序
- 创建虚拟环境

`mkvirtualenv 环境名称`

- 安装Django==1.9

- 安装PyMySQL

	> 我学的视频是python2.7的，我用的是python3.6，所以配置数据库的时候有点不一样，首先要安装MYSQL的驱动，否则后续会报错

	> `MySQL_python-1.2.5-cp27-none-win_amd64.wh`

	> 由于我用的python3.6，所以将这里下载好的驱动文件的 __cp27__ 改成 __cp36__ 就可以正常安装了，否则可能会报错

	> 还需要在 `__init.py__` 文件中加入

	```
	import pymysql
	pymysql.install_as_MySQLdb()
	```

- 配置数据库

	现在MySQL中创建好空的数据库，然后在setting.py中配置
	```
	DATABASES = {
		'default': {
		'ENGINE': 'django.db.backends.mysql',
		'NAME': 'mxonline',
		'USER': 'root',
		'PASSWORD': 'q8621587',
		'HOST': '127.0.0.1'
		}
	}
	```
	然后在pycharm中 工具--run manage.py Task...,然后输入
	`makemigrations`，执行（可能会报错，原因很多，根据提示百度）
	再输入`migrate`,执行，会在数据库中生成表。


## 目录
- django app设计

	> user-用户管理

	> course-课程管理

	> organization-机构和教师管理

	> operation-用户操作管理

- 各个app models 设计
- 数据表生成与修改

---

项目-在线教育平台-幕学在线网

- app生成和设置
	- pycharm中 工具--run manage.py Task...,然后输入`startapp users`
	- 编写models
	users/models.py
	```
	from django.contrib.auth.models import AbstractUser
	class UserProfile(AbstractUser):
    '''
    增加数据库默认表中没有的字段，就是重写users的models
    '''
    nick_name = models.CharField(max_length=50, verbose_name=u'昵称', default='')
    birday = models.DateField(verbose_name=u'生日', null=True, blank=True)
    gender = models.CharField(choices=(('male',u'男'),('female',u'女')),default='female', max_length=5)
    address = models.CharField(max_length=100, default=u'')
    mobile = models.CharField(max_length=11, null=True, blank=True)
    image = models.ImageField(upload_to='img/%Y/%m', default=u'image/default.png', max_length=100)

    class Meta:
        verbose_name = '用户信息'
        verbose_name_plural = verbose_name

    def __unicode__(self):
        return self.username
	```
	由于用到image，所以需要安装pillow，用pip安装即可
	`pip install pillow`
	- 配置setting.py
	```
	\#添加APP
	INSTALLED_APPS = [
		......
		'users'
	]
	AUTH_USER_MODEL = 'users.UserProfile' \#重写
	```
	pycharm中 工具--run manage.py Task...,然后输入
	`makemigrations users`
	`migrate users`
	`yes`
	